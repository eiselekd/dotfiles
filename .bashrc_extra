#if [ -f ${HOME}/git/dotfiles/.bashrc_extra ]; then
#    . ${HOME}/git/dotfiles/.bashrc_extra
#fi

#BASHEXTRADIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"
#export PATH=$PATH:${BASHEXTRADIR}/.xmonad/

alias ovc='openssl x509 -text -noout -in ' 
alias ovk='openssl rsa -text -noout -in ' 

# Avoid duplicates
export HISTCONTROL=ignoredups:erasedups
# When the shell exits, append to the history file instead of overwriting it
shopt -s histappend

# After each command, append to the history file and reread it
# export PROMPT_COMMAND="${PROMPT_COMMAND:+$PROMPT_COMMAND$'\n'}history -a; history -c; history -r"
# add /etc/rsyslog.d/bash.conf:
# local6.*    /var/log/commands.log
# export PROMPT_COMMAND='RETRN_VAL=$?;logger -p local6.debug "$(whoami) [$$]: $(history 1 | sed "s/^[ ]*[0-9]\+[ ]*//" ) [$RETRN_VAL]"'

export LOGDIR=${HOME}/logs

alias em="emacs -nw"

function record () {
   d=`date +"%Y-%m-%d-%H-%M-%S"`
   if [ ! -d ${LOGDIR} ]; then mkdir -p ${LOGDIR}; fi
   touch ${LOGDIR}/${d}
   script  -a ${LOGDIR}/${d}
   history > ${LOGDIR}/${d}.history


   exec 1> >(logger -s -t $(basename $0)) 2>&1
}

# enable this to log to journalctl -f
# exec 1> >(logger -s -t $(basename $0)) 2>&1
# exec > >(logger -p user.info) 2> >(logger -p user.warn)


alias ovc="openssl x509 -noout -text -in "
alias ovk="openssl rsa  -noout -text -in "

alias sshp='ssh -o PreferredAuthentications=password -o PubkeyAuthentication=no '
alias scpp='scp -o PreferredAuthentications=password -o PubkeyAuthentication=no '
alias xshare='x11vnc -display :0 -auth .Xauthority'

duh()
{
	du -h --max-depth 1 $1 | sort -h | tac
}

zfsprotect()
{
	sudo zfs set readonly=on rpool/ROOT/ubuntu
}

zfsunprotect()
{
	sudo zfs set readonly=off rpool/ROOT/ubuntu
}

zfsprotstatus()
{
	sudo zfs get -H -r readonly rpool
}

zfssnapshots()
{
	sudo zfs list -r -t snapshot rpool/ROOT rpool/home
}

zfstakesnapshot()
{
	sudo zfs list 
	sudo zfs snapshot rpool/home/eiselekd@`date +'%Y-%m-%d'`
	sudo zfs snapshot rpool/ROOT/ubuntu@`date +'%Y-%m-%d'`
	sudo zfs snapshot rpool/home/root@`date +'%Y-%m-%d'`
	sudo zfs list -t snapshot
}

zfsdiff()
{
	sudo bash ${HOME}/git/dotfiles/ubuntu/zfs_do_diff.sh $1 $2 $3
}

nsidof()
{
    nsid=$(ps faux | grep -A 1 "lxc $1" | grep -v grep | grep "init" | awk '{print $2}')
    echo $nsid
}

xset b off

alias rsynca="rsync -av "
alias sshp="ssh -o PreferredAuthentications=password -o PubkeyAuthentication=no "

alias segfault="env SEGFAULT_SIGNALS='abrt segv' LD_PRELOAD=/lib/x86_64-linux-gnu/libSegFault.so"

if [ ! -z "${DISPLAY}" ]; then 
   echo #xinput set-prop 13 "Device Enabled" 0
fi

